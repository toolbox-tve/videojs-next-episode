/*! @name videojs-next-episode @version 0.0.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsNextEpisode=t(e.videojs)}(this,function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var n=(e=e&&e.hasOwnProperty("default")?e.default:e).dom||e,s=function(e){function i(t,i){var n;return(n=e.call(this,t,i)||this).parent=i.parent,n}t(i,e);var s=i.prototype;return s.createEl=function(){var e=n.createEl("div",{className:"vjs-next-episode-image-div"});return this.playIcon=n.createEl("span",{className:"vjs-icon-play-circle"}),this.episodeImg=n.createEl("img",{src:this.options_.imgUrl,className:"vjs-next-episode-image"}),e.appendChild(this.playIcon),e.appendChild(this.episodeImg),e},s.updateEl=function(e){this.options_=e,this.episodeImg.src=this.options_.imgUrl},s.resize=function(){console.log("IMAGE RES"),this.episodeImg.height+2!==this.parent.height()&&(this.episodeImg.height=this.parent.height()-2)},s.handleClick=function(){console.log("HANDLES CLICK"),this.parent.goToNextEpisode()},i}(e.getComponent("ClickableComponent"));e.registerComponent("NextEpisodeImage",s);var o=e.dom||e,a=function(e){function i(t,i){var n;return(n=e.call(this,t,i)||this).parent=i.parent,n}t(i,e);var n=i.prototype;return n.createEl=function(){var e=o.createEl("div",{className:"vjs-control vjs-button vjs-next-episode-close-btn"}),t=o.createEl("span",{className:"vjs-icon-cancel"});return e.appendChild(t),e},n.handleClick=function(e){this.parent.closed=!0,this.parent.hide()},i}(e.getComponent("ClickableComponent"));e.registerComponent("NextEpisodeCloseButton",a);var r=e.dom||e,l=function(e){function n(t,n){var s;return(s=e.call(this,t,n)||this).lastWidth=0,s.parent=n.parent,s.player_.on("timeupdate",s.onTimeUpdate.bind(i(i(s)))),s}t(n,e);var s=n.prototype;return s.createEl=function(){var e=r.createEl("div",{className:"vjs-next-episode-summary"});return this.spanCounter=r.createEl("span",{className:"vjs-next-episode-counter"}),this.spanColored=r.createEl("span"),this.spanTitle=r.createEl("span",{className:"vjs-next-episode-title"}),this.spanCounter.innerHTML=this.localize("Next episode in "),this.spanColored.innerHTML=this.localize("{1} seconds",[this.player_.currentTime()]),this.spanTitle.innerHTML=this.generateTitle(),this.spanCounter.appendChild(this.spanColored),e.appendChild(this.spanCounter),e.appendChild(this.spanTitle),e},s.updateEl=function(e){this.options_=e,this.spanTitle.innerHTML=this.generateTitle()},s.generateTitle=function(){var e,t,i;return this.options_.title&&(e='"'+this.options_.title+'"'),this.options_.episode&&(i=this.localize("Episode {1}",[this.options_.episode]),i+=e?" ":""),this.options_.season&&(t=this.localize("Season {1}",[this.options_.season]),t+=i?" - ":""),""+t+i+e},s.onTimeUpdate=function(){var e=+(this.player_.duration()-this.player_.currentTime()).toFixed(0);this.spanColored.innerHTML=this.localize("{1} seconds",[e])},s.resize=function(){console.log("TEXT RES");var e=this.width();this.lastWidth!==e&&(this.lastWidth=e,e<200?(this.spanCounter.style.fontSize="10px",this.spanTitle.style.fontSize="10px"):e<300?(this.spanCounter.style.fontSize="14px",this.spanTitle.style.fontSize="14px"):e<400?(this.spanCounter.style.fontSize="16px",this.spanTitle.style.fontSize="16px"):(this.spanCounter.style.fontSize="20px",this.spanTitle.style.fontSize="20px"))},n}(e.getComponent("Component"));e.registerComponent("NextEpisodeSummary",l);var p=e.dom||e,d=function(e){function n(t,n){var s;(s=e.call(this,t,n)||this).changeSrc=n.changeSrcCallback;var o=n.content,a=(o.images&&o.images.find(function(e){return"THUMB"===e.type})).image||o.images.length&&o.images[0].image;return s.contentId=o.id,s.image=s.addChild("NextEpisodeImage",{imgUrl:a,parent:i(i(s))}),s.summary=s.addChild("NextEpisodeSummary",{title:o.title,episode:o.episode,season:o.season}),s.closeButton=s.addChild("NextEpisodeCloseButton",{parent:i(i(s))}),s.open=!1,s.closed=!1,s.player_.on("timeupdate",s.onTimeUpdate.bind(i(i(s)))),s.player_.on("playerresize",s.onPlayerResize.bind(i(i(s)))),s}t(n,e);var s=n.prototype;return s.createEl=function(){return p.createEl("div",{className:"vjs-next-episode-container vjs-hidden"})},s.updateEl=function(e){},s.onTimeUpdate=function(){var e=+(this.player_.duration()-this.player_.currentTime()).toFixed(0);!this.open&&!this.closed&&this.options_.secToEnd>=e?(this.show(),this.onPlayerResize()):this.open&&this.options_.secToEnd<e&&this.hide(),e<=1&&(console.log("CHANGE SRC"),this.goToNextEpisode())},s.show=function(){e.prototype.show.call(this),this.open=!0},s.hide=function(){e.prototype.hide.call(this),this.open=!1},s.onPlayerResize=function(){this.image.resize(),this.summary.resize()},s.goToNextEpisode=function(){this.changeSrc(this.contentId)},n}(e.getComponent("Component"));e.registerComponent("NextEpisode",d);var c={title:"",secToEnd:15,posterImage:"",url:"",content:{audioOnly:!1,clip:!1,contentType:"EPISODE",description:"Cuando el testigo en contra de Emily es asesinado,  Nick y Emily deberán probar su inocencia antes de que Tommy Gibbs y el departamento de policía la arresten.",duration:2742,episode:3,externalId:"16013397",flights:[{flights:[{start:"2017-11-10T08:00:00.000Z",end:"2020-11-03T06:00:00.000Z"}],network:"crackle"}],free:!1,genres:["Crimen"],hd:!1,id:"t78wbi",images:[{imageBin:null,image:"http://images-es-am.crackle.com/1/v/j0/wfryk_tne.jpg?ts=20171010213620",contentType:null,checksum:"0c5b9c0994da02a3a7415bdd60fb013fa31cb1af",uuid:null,unityImagePath:"/images/{clientId}/content/5a0583487251b34fee0b315c/0c5b9c0994da02a3a7415bdd60fb013fa31cb1af/0c5b9c0994da02a3a7415bdd60fb013fa31cb1af.png",type:"THUMB",size:{height:224,ratio:1.7857142857142858,width:400}},{imageBin:null,image:"http://images-es-az.crackle.com/profiles/channels/100002174/OneSheetImage_800x1200.jpg?ts=20171027103436",contentType:null,checksum:"20d2a0c61bdabb156ebf45664f532360aeb1423b",uuid:null,unityImagePath:"/images/{clientId}/content/5a0583487251b34fee0b315c/20d2a0c61bdabb156ebf45664f532360aeb1423b/20d2a0c61bdabb156ebf45664f532360aeb1423b.png",type:"POSTER",size:{height:1200,ratio:.6666666666666666,width:800}}],live:!1,replay:!1,networks:[{name:"Crackle",embed:!0,network:"crackle",contentId:"5a058348d4d08d2917e05283"}],participants:{director:["Oded Ruskin"],writer:["Elaina Perpelitt"],cast:["Stana Katic","Patrick Heusinger","Cara Theobold"]},payPerView:!1,ratings:["PG","R"],season:1,serie:{_id:"5a2a5eaa7251b34fee13eb0a",id:"iw29eh",title:"Absentia",alternativeTitle:null},title:"The Emily Show",entitlementTypes:["deeplink","media","redirect"],urn:"urn:tve:crackle",streamCastConfig:{device:{chromecast:!0}}}},h=function(i){function n(t,n){var s;return(s=i.call(this,t)||this).options=e.mergeOptions(c,n),s.player.ready(function(){s.player.addClass("vjs-next-episode")}),s.container=t.addChild("NextEpisode",s.options),s}return t(n,i),n}(e.getPlugin("plugin"));return h.defaultState={},h.VERSION="0.0.0",e.registerPlugin("nextEpisode",h),h});
